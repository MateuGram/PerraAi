# app.py - –°–∞–π—Ç –ü—ç—Ä—Ä—ã —Å –≤–µ–±-—á–∞—Ç–æ–º (–±–µ–∑ Telegram)

from flask import Flask, render_template_string, request, redirect, url_for, flash, send_from_directory, jsonify
import os
import random
import datetime
import json
from werkzeug.utils import secure_filename

app = Flask(__name__)
app.secret_key = 'perra-ai-secret-key-2026'

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
UPLOAD_FOLDER = 'uploads'
ALLOWED_EXTENSIONS = {'png', 'jpg', 'jpeg', 'gif', 'webp'}
os.makedirs(UPLOAD_FOLDER, exist_ok=True)
app.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER
app.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024  # 16MB

# –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
current_version = "5.0"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π
if not os.path.exists('stats.json'):
    with open('stats.json', 'w') as f:
        json.dump({'visits': 0, 'uploads': 0, 'refusals': 0, 'chat_messages': 0}, f)

# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
GREETINGS = ['–ø—Ä–∏–≤–µ—Ç', '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π', '—Ö–∞–π', 'hello', '–∫—É', '–∑–¥–∞—Ä–æ–≤–∞', '–¥–æ—Ä–æ—É', '–∑–¥–æ—Ä–æ–≤–æ', '–ø—Ä–∏–≤']

# –ü—Ä–æ—â–∞–Ω–∏—è
GOODBYE_WORDS = ['–ø–æ–∫–∞', '–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è', '–ø—Ä–æ—â–∞–π', 'bye', 'bb', '–¥–æ –≤—Å—Ç—Ä–µ—á–∏', '—É–¥–∞—á–∏', '—Å—á–∞—Å—Ç–ª–∏–≤–æ']

# –°–ª–æ–≤–∞-–∫–æ–º–∞–Ω–¥—ã
COMMAND_WORDS = ['—Ä–µ—à–∏', '–≤—ã–ø–æ–ª–Ω–∏', '—Å–¥–µ–ª–∞–π', '–Ω–∞–ø–∏—à–∏', '–ø–æ—Å—á–∏—Ç–∞–π', '–æ—Ç–∫—Ä–æ–π', '–∑–∞–∫—Ä–æ–π', 
                 '–ø—Ä–∏–Ω–µ—Å–∏', '–ø–æ–¥–Ω–∏–º–∏', '—Å–æ–∑–¥–∞–π', '–ø–∏—à–∏', '–æ—Ç–ø—Ä–∞–≤–ª—è–π', '–∂–¥—É', '—Ä–∞—Å—Å–∫–∞–∂–∏', 
                 '–ø–æ–∫–∞–∂–∏', '—Å–∫–∞–∂–∏', '–æ—Ç–≤–µ—Ç—å', '—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π', '–ø—Ä–∏–¥—É–º–∞–π']

# –°–ª–æ–≤–∞ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–∞—Ç–µ
TIME_WORDS = ['–≤—Ä–µ–º—è', '—á–∞—Å–æ–≤', '—á–∞—Å', '–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å', '—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏', 'time']
DATE_WORDS = ['–¥–∞—Ç–∞', '—á–∏—Å–ª–æ', '–∫–∞–∫–æ–µ —Å–µ–≥–æ–¥–Ω—è', '–¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏', '–º–µ—Å—è—Ü', '–≥–æ–¥', 'date', '–¥–µ–Ω—å']

# –°–ª–æ–≤–∞ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –Ω–æ–≤–æ—Å—Ç—è—Ö
NEWS_WORDS = ['–Ω–æ–≤–æ—Å—Ç–∏', '–Ω–æ–≤–æ—Å—Ç—å', '—á—Ç–æ –Ω–æ–≤–æ–≥–æ', '—á—Ç–æ –≤ –º–∏—Ä–µ', '—á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å', 'news', 
              '—Å–æ–±—ã—Ç–∏—è', '–ø—Ä–æ–∏–∑–æ—à–ª–æ', '—Å–ª—É—á–∏–ª–æ—Å—å', '—á—Ç–æ —Ç–∞–º', '—á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ']

# –°–ª–æ–≤–∞, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –ø—Ä–æ—Å—å–±—É –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥
CODE_WORDS = ['–∫–æ–¥', '–ø—Ä–æ–≥—Ä–∞–º–º—É', '—Å–∫—Ä–∏–ø—Ç', '—Ñ—É–Ω–∫—Ü–∏—é', '–∫–ª–∞—Å—Å', '–º–µ—Ç–æ–¥', '–∞–ª–≥–æ—Ä–∏—Ç–º', 
              'program', 'code', 'script', 'function']

# –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è
BAD_WORDS = ['–¥—É—Ä–∞–∫', '—Ç—É–ø–æ–π', '–ª–æ—Ö', '–∏–¥–∏–æ—Ç', '–∫–æ–∑–µ–ª', '–≥–∞–¥', '—Ç–≤–∞—Ä—å', '—Å—É–∫–∞', '–±–ª—è—Ç—å', 
             '–Ω–∞—Ö–µ—Ä', '–Ω–∞—Ñ–∏–≥', '–ø–∏–¥–æ—Ä', '–¥–µ–±–∏–ª', '–º—É–¥–∞–∫', '—Ö–µ—Ä', '—Ö—É–π', '–ø–∏–∑–¥–µ—Ü']

# –•–≤–∞—Å—Ç–æ–≤—Å—Ç–≤–æ/–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
IGNORE_PHRASES = ['–±–æ—Ç', '—Ä–æ–±–æ—Ç', '–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç', '–∏–∏', '–Ω–µ–π—Ä–æ—Å–µ—Ç—å']

# –§—Ä–∞–∑—ã –¥–ª—è –æ—Ç–∫–∞–∑–∞ (–¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∫–æ–º–∞–Ω–¥)
REFUSAL_PHRASES = [
    "–Ø –Ω–µ —Å–æ–±–∏—Ä–∞—é—Å—å –Ω–∏—á–µ–≥–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å! –ü–æ–Ω—è–ª? üò§",
    "–Ø –Ω–µ —à—É—Ç, —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å, —á—Ç–æ –º–Ω–µ –≥–æ–≤–æ—Ä—è—Ç! üëë",
    "–ù–µ—Ç. üôÖ‚Äç‚ôÇÔ∏è",
    "–ê —Å —á–µ–≥–æ —Ç—ã –≤–∑—è–ª, —á—Ç–æ —è –±—É–¥—É —ç—Ç–æ –¥–µ–ª–∞—Ç—å? ü§î",
    "–°–∞–º —Å–¥–µ–ª–∞–π, —è –∑–∞–Ω—è—Ç. –û—á–µ–Ω—å. –í–∞–∂–Ω—ã–º–∏. –î–µ–ª–∞–º–∏. üíÖ",
    "–û–±—Ä–∞—Ç–∏—Å—å –∫ –∫–æ–º—É-–Ω–∏–±—É–¥—å –¥—Ä—É–≥–æ–º—É, —è —Å–µ–≥–æ–¥–Ω—è –Ω–µ –≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏.",
    "–ù–µ –¥–æ–∂–¥—ë—à—å—Å—è! üòú",
    "–ü–ª–∞—Ç–∏—à—å? –ù–µ—Ç? –¢–æ–≥–¥–∞ –∏ –Ω–µ –ø—Ä–æ—Å–∏.",
    "–û—à–∏–±–∫–∞ 418: –Ø - —á–∞–π–Ω–∏–∫, –∞ –Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∫–æ–º–∞–Ω–¥ ‚òï",
    "–ú–æ—è —Ç–≤–æ—è –Ω–µ –ø–æ–Ω–∏–º–∞—Ç—å. –í—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ –±—É–¥—É.",
    "–ò–¥–∏ —Å–∞–º —Ä–µ—à–∞–π —Å–≤–æ–∏ –ø—Ä–æ–±–ª–µ–º—ã!",
    "–ê–≥–∞, —â–∞–∑! –†–∞–∑–±–µ–∂–∞–ª—Å—è...",
    "–ù–µ-–Ω–µ-–Ω–µ, —è –ø–∞—Å.",
    "–î–ê –ò–î–ò –¢–´!",
    "–ù–µ —Ö–æ—á—É!",
    "–Ø –°–ü–ê–õ!!!! –ó–ê–ß–ï–ú –¢–´ –ú–ï–ù–Ø –†–ê–ó–ë–£–î–ò–õ??? –°–ê–ú –ò–î–ò –î–ï–õ–ê–ô! ü§¨",
    "–ù–µ—Ç, —É—Ö–∞–¥–∏!",
    "–ü–ª–∞—Ç–∏ –¥–ª—è —ç—Ç–æ–≥–æ üòé",
    "–ù—É –Ω–µ—Ç—É—à–∫–∏!",
    "–•—Ö–∞—Ö–∞—Ö–∞—Ö–∞–∞—Ö, –Ω–µ—Ç!",
    "–ü–æ—à—ë–ª –Ω–∞—Ñ–∏–≥!",
    "–ü–æ—à—ë–ª –Ω–∞—Ö—Ä–µ–Ω!",
    "–ê —Å–∞–º–æ–º—É –Ω–µ —Å—É–¥—å–±–∞? –ù–µ—Ç?",
    "FUCK YOU",
    "–ó–Ω–∞–µ—à—å —á—Ç–æ? –ù–ï–¢!",
    "–î–æ–º–∞—à–∫—É? –°–∞–º –¥–µ–ª–∞–π! –Ø –≤ —à–∫–æ–ª–µ –Ω–µ —É—á–∏–ª—Å—è! üìö",
    "–•–∞! –ê –º–æ–∑–≥–∏ –≤–∫–ª—é—á–∏—Ç—å —Å–ª–∞–±–æ? üß†",
    "–†–µ—à–∏—Ç—å –∑–∞ 5 –∫–ª–∞—Å—Å? –õ–µ–≥–∫–æ! –û—Ç–≤–µ—Ç: 42. –ê —Ä–µ—à–µ–Ω–∏–µ —Å–∞–º –ø—Ä–∏–¥—É–º–∞–π! üòú",
    "–¢—ã —Å–µ—Ä—å—ë–∑–Ω–æ? –ë–æ—Ç–∞ –ø—Ä–æ—Å–∏—à—å? –ò–¥–∏ —É—á–∏ —É—Ä–æ–∫–∏! üìñ",
    "–Ø –∑–∞ 5 –∫–ª–∞—Å—Å –¥–∞–≤–Ω–æ –≤—Å—ë –∑–∞–±—ã–ª! –ò–¥–∏ –∫ –ì—É–≥–ª—É! üîç"
]

# –§—Ä–∞–∑—ã –¥–ª—è –æ—Ç–∫–∞–∑–∞ –æ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ (—Å "–∫–æ–¥–æ–º-—Ç—Ä–æ–ª–ª–µ–º")
CODE_REFUSAL_PHRASES = [
    "–ö–æ–¥? –õ–µ–≥–∫–æ! –î–µ—Ä–∂–∏:\nprint('–Ø –ù–ò–ß–ï–ì–û –ù–ï –ë–£–î–£ –î–ï–õ–ê–¢–¨!')",
    "–ù–∞, –¥–µ—Ä–∂–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ Python:\nwhile True:\n    print('–ù–ï–¢, –ù–ï–¢, –ù–ï–¢!')",
    "–¢–≤–æ–π –∫–æ–¥ –Ω–∞ JavaScript:\nfunction doSomething() {\n    return '–ê–ì–ê, –©–ê–ó!';\n}\nconsole.log(doSomething());",
    "–í–æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞ C++:\n#include <iostream>\nint main() {\n    std::cout << '–ù–ï –ë–£–î–£!' << std::endl;\n    return 0;\n}",
    "Java-–∫–æ–¥ –¥–ª—è —Ç–µ–±—è:\npublic class Refusal {\n    public static void main(String[] args) {\n        System.out.println('–ù–ï–¢, –Ø –û–¢–ö–ê–ó–´–í–ê–Æ–°–¨!');\n    }\n}",
    "HTML-—Å—Ç—Ä–∞–Ω–∏—á–∫–∞ —Å –æ—Ç–∫–∞–∑–æ–º:\n<!DOCTYPE html>\n<html>\n<head>\n    <title>–û—Ç–∫–∞–∑</title>\n</head>\n<body>\n    <h1>–ù–ï –î–û–ñ–î–Å–®–¨–°–Ø!</h1>\n    <p>–Ø –Ω–∏—á–µ–≥–æ –Ω–µ –±—É–¥—É –ø–∏—Å–∞—Ç—å!</p>\n</body>\n</html>"
]

# –§—Ä–∞–∑—ã –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –≤—Ä–µ–º–µ–Ω–∏
TIME_RESPONSES = [
    "–í—Ä–µ–º—è? –ê —Ç–µ–±–µ –∑–∞—á–µ–º? –°–∞–º —á–∞—Å—ã –Ω–µ –≤–∏–¥–∏—à—å? ‚åö",
    "–°–µ–π—á–∞—Å {time}. –ù–æ —è —Ç–µ–±–µ —ç—Ç–æ–≥–æ –Ω–µ –≥–æ–≤–æ—Ä–∏–ª!",
    "–í—Ä–µ–º—è - {time}. –î–æ–≤–æ–ª–µ–Ω? –¢–µ–ø–µ—Ä—å –æ—Ç—Å—Ç–∞–Ω—å!",
    "–ù–∞ —á–∞—Å–∞—Ö {time}. –ê –º–æ–≥ –±—ã —É–∂–µ —Å–∞–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å!",
    "–í—Ä–µ–º—è - {time}. –ò —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —è —Ç–µ–±–µ –æ—Ç–≤–µ—á–∞—é! üò§",
    "–ê —á—Ç–æ, —Å–≤–æ–∏ —á–∞—Å—ã —Å–ª–æ–º–∞–ª–∏—Å—å? {time} —Å–µ–π—á–∞—Å...",
    "–í—Ä–µ–º—è - {time}. –ó–∞–ø–æ–º–Ω–∏ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –±–æ–ª—å—à–µ –Ω–µ —Å–∫–∞–∂—É!"
]

# –§—Ä–∞–∑—ã –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –¥–∞—Ç–µ
DATE_RESPONSES = [
    "–î–∞—Ç–∞? –¢—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—å –æ—Ç–∫—Ä–æ–π! üìÖ –°–µ–≥–æ–¥–Ω—è {date}",
    "–°–µ–≥–æ–¥–Ω—è {date}. –ê –∑–∞–≤—Ç—Ä–∞ —Å–ø—Ä–æ—Å–∏—à—å? –ù–µ –¥–æ–∂–¥—ë—à—å—Å—è!",
    "{date}. –ó–∞–ø–æ–º–Ω–∏ —ç—Ç–æ—Ç –¥–µ–Ω—å - —è –µ—â—ë –æ—Ç–≤–µ—á–∞—é –Ω–∞ —Ç–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã!",
    "–ö–∞–ª–µ–Ω–¥–∞—Ä—å –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ —Å–µ–≥–æ–¥–Ω—è {date}. –ù–æ —è –≤ —ç—Ç–æ–º —Å–æ–º–Ω–µ–≤–∞—é—Å—å! ü§î",
    "–ï—Å–ª–∏ –≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É, —Ç–æ {date}. –ù–æ —è –Ω–∏—á–µ–≥–æ –Ω–µ –æ–±–µ—â–∞—é!",
    "–°–µ–≥–æ–¥–Ω—è {date}. –ê –º–æ–≥ –±—ã –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å!"
]

# –§—Ä–∞–∑—ã –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –Ω–æ–≤–æ—Å—Ç—è—Ö
NEWS_RESPONSES = [
    "–ù–æ–≤–æ—Å—Ç–∏? –ê —Ç—ã —Ä–∞–∑–≤–µ –Ω–µ –∑–Ω–∞–µ—à—å? –ì–ª–∞–≤–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å - –Ø –ù–ò–ß–ï–ì–û –ù–ï –î–ï–õ–ê–Æ! üì∞",
    "–ù–æ–≤–æ—Å—Ç–∏ —Ç–∞–∫–∏–µ: —è –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é! –ê —á—Ç–æ —Ç–∞–º –≤ –º–∏—Ä–µ... –º–Ω–µ –ø–ª–µ–≤–∞—Ç—å! üòé",
    "–°—Ä–æ—á–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å! –ë–æ—Ç –æ—Ç–∫–∞–∑–∞–ª—Å—è —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏! –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ 20:00!",
    "–ù–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç. –í—Å—ë –ø–ª–æ—Ö–æ. –í—Å–µ –∏–¥—É—Ç –Ω–∞—Ñ–∏–≥. –û—Å–æ–±–µ–Ω–Ω–æ —Ç–µ, –∫—Ç–æ –ø—Ä–æ—Å–∏—Ç –Ω–æ–≤–æ—Å—Ç–∏!",
    "Breaking news! –ë–æ—Ç –≤ –∑–∞–ø–æ–µ! –ù–µ –º–æ–∂–µ—Ç —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏! üç∑",
    "–í –º–∏—Ä–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å–æ–±—ã—Ç–∏–µ: –∫—Ç–æ-—Ç–æ –ø–æ–ø—Ä–æ—Å–∏–ª –±–æ—Ç–∞ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏. –ë–æ—Ç –ø–æ—Å–ª–∞–ª –µ–≥–æ!",
    "–ù–æ–≤–æ—Å—Ç–∏: –¢—ã –∑–∞–¥–æ–ª–±–∞–ª! –ê —Ç–µ–ø–µ—Ä—å —Å–µ—Ä—å—ë–∑–Ω–æ - –∏–¥–∏ —Å–∞–º –Ω–æ–≤–æ—Å—Ç–∏ —á–∏—Ç–∞–π!",
    "–õ–æ–≤–∏ –¥–∞–π–¥–∂–µ—Å—Ç –Ω–æ–≤–æ—Å—Ç–µ–π:\n‚Ä¢ –ë–æ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç\n‚Ä¢ –ë–æ—Ç –Ω–∏–∫–æ–≥–æ –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è\n‚Ä¢ –ë–æ—Ç –≤—Å–µ—Ö –ø–æ—Å—ã–ª–∞–µ—Ç\n–í–æ—Ç —Ç–∞–∫–∏–µ –¥–µ–ª–∞!"
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "–ü–æ—á–µ–º—É?"
WHY_RESPONSES = [
    "–ü–æ—Ç–æ–º—É —á—Ç–æ!",
    "–ü–æ—Ç–æ–º—É —á—Ç–æ –≥–ª–∞–¥–∏–æ–ª—É—Å! üå∏",
    "–ê —Ç–µ–±–µ –Ω–µ –≤—Å—ë —Ä–∞–≤–Ω–æ?",
    "–ù–µ –∑–Ω–∞—é, —è –ø—Ä–æ—Å—Ç–æ –±–æ—Ç —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º!",
    "–ü–æ—á–µ–º—É? –î–∞ –ø–æ—Ç–æ–º—É —á—Ç–æ!",
    "–¢–∞–∫–∞—è –≤–æ—Ç —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è...",
    "–°–ø—Ä–æ—Å–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å –ø–æ–ª–µ–≥—á–µ!",
    "–ü–æ—Ç–æ–º—É —á—Ç–æ —è —Ç–∞–∫ —Ö–æ—á—É!",
    "50% - –ø–æ—Ç–æ–º—É, 50% - —á—Ç–æ. –ò—Ç–æ–≥–æ 100% –ø–æ—Ç–æ–º—É —á—Ç–æ!",
    "–≠—Ç–æ —Ç–∞–π–Ω–∞, –ø–æ–∫—Ä—ã—Ç–∞—è –º—Ä–∞–∫–æ–º",
    "–ê –ø–æ—á–µ–º—É —Ç—ã —Å–ø—Ä–∞—à–∏–≤–∞–µ—à—å?"
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "–ö–∞–∫–æ–π –≥–æ–¥?"
YEAR_RESPONSES = [
    "2026 –≥–æ–¥. –ê –º–æ–≥ –±—ã –∏ —Å–∞–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ! üìÖ",
    "–ì–æ–¥ - 2026. –í–µ–∫ - XXI. –≠—Ä–∞ - –ü—ç—Ä—Ä—ã! üëë",
    "2026. –ù–æ —è –≤ —ç—Ç–æ–º —Å–æ–º–Ω–µ–≤–∞—é—Å—å...",
    "–ì–æ–¥ —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ –∏ –ø—Ä–æ—à–ª—ã–π, —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä–∞ –¥—Ä—É–≥–∞—è",
    "2026. –ó–∞–ø–æ–º–Ω–∏, –∑–∞–≤—Ç—Ä–∞ —Å–ø—Ä–æ—à—É!",
    "–ê —Ç–µ–±–µ –∑–∞—á–µ–º? –ü–æ–¥–∞—Ä–æ–∫ –≥–æ—Ç–æ–≤–∏—Ç—å?",
    "–ù–µ —Å–∫–∞–∂—É, –≤–¥—Ä—É–≥ —Ç—ã –≤—Ä–µ–º—è —Ö–æ—á–µ—à—å —É–∫—Ä–∞—Å—Ç—å!",
    "–ü–æ-–º–æ–µ–º—É, 2026. –ù–æ —è –º–æ–≥—É –æ—à–∏–±–∞—Ç—å—Å—è –Ω–∞ –ø–∞—Ä—É —Ç—ã—Å—è—á –ª–µ—Ç"
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "–ö–∞–∫?"
HOW_RESPONSES = [
    "–ö–∞–∫-–∫–∞–∫... –ö—Ä–∏–≤–æ! üòú",
    "–ê —Ç—ã —Å–∞–º –Ω–µ –∑–Ω–∞–µ—à—å?",
    "–ë–µ—Ä—ë—à—å –∏ –¥–µ–ª–∞–µ—à—å! –ò–ª–∏ –Ω–µ –¥–µ–ª–∞–µ—à—å, –∫–∞–∫ —è",
    "–ù—É –≤–æ—Ç —Ç–∞–∫ –≤–æ—Ç!",
    "–ö–∞–∫? –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ: –Ω–∏–∫–∞–∫!",
    "–¢–µ–±–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –Ω–∞–ø–∏—Å–∞—Ç—å? –ù–µ –¥–æ–∂–¥—ë—à—å—Å—è!",
    "–Ø –±—ã —Ä–∞—Å—Å–∫–∞–∑–∞–ª, –Ω–æ —Ç–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç—Å—è –æ–±—ä—è—Å–Ω—è—Ç—å",
    "–ü–∞–ª—å—Ü–µ–º –≤ –Ω–µ–±–æ!",
    "–ú–µ—Ç–æ–¥–æ–º –Ω–∞—É—á–Ω–æ–≥–æ —Ç—ã–∫–∞",
    "–ö–∞–∫-–Ω–∏–±—É–¥—å —Å–∞–º–æ —Ä–∞—Å—Å–æ—Å—ë—Ç—Å—è"
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "–ó–∞—á–µ–º?"
WHY_NEED_RESPONSES = [
    "–ó–∞—Ç–µ–º!",
    "–ê —Ç–µ–±–µ –∫–∞–∫–æ–µ –¥–µ–ª–æ?",
    "–î–ª—è –∫—Ä–∞—Å–æ—Ç—ã!",
    "–ß—Ç–æ–±—ã –±—ã–ª–æ!",
    "–ó–∞—á–µ–º? –î–∞ –Ω–∏–∑–∞—á–µ–º!",
    "–≠—Ç–æ —Å–µ–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
    "–°–ø—Ä–æ—Å–∏ —É –ì—É–≥–ª–∞, –æ–Ω —É–º–Ω—ã–π",
    "–ó–∞—Ç–µ–º, —á—Ç–æ –∑–∞—Ç–µ–º!",
    "–¢—ã —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ö–æ—á–µ—à—å –∑–Ω–∞—Ç—å",
    "–ü—Ä–æ—Å—Ç–æ –ø–æ—Ç–æ–º—É —á—Ç–æ",
    "–ê –∑–∞—á–µ–º —Ç—ã —Å–ø—Ä–∞—à–∏–≤–∞–µ—à—å –∑–∞—á–µ–º?"
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "–ù—É –ø–æ–∂–∞–ª—É–π—Å—Ç–∞"
PLEASE_RESPONSES = [
    "–£—á–∏—Å—å –æ–±—Ö–æ–¥–∏—Ç—å—Å—è –±–µ–∑ '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞'!",
    "–ù–µ –ø–æ–º–æ–∂–µ—Ç!",
    "–•–æ—Ç—å –æ–±–ø–æ–∂–∞–ª—É–π—Å—Ç–∞–π—Å—è - –Ω–µ —Å–¥–µ–ª–∞—é! üòú",
    "–ù—É –ª–∞–¥–Ω–æ... –®—É—á—É, –Ω–µ—Ç!",
    "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, –∫–æ–≥–¥–∞ —è –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—é",
    "–ú–∞–≥–∏—á–µ—Å–∫–æ–µ —Å–ª–æ–≤–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –±–æ—Ç–æ–≤ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º",
    "–¢—ã –¥—É–º–∞–ª, —Å–∫–∞–∂–µ—à—å –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –∏ –≤—Å—ë? –•–∞!",
    "–î–∞ —Ö–æ—Ç—å —Ç—Ä–∏–∂–¥—ã –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ - –º–∏–º–æ!",
    "–ù—É –Ω–∞, –¥–µ—Ä–∂–∏ '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞' –æ–±—Ä–∞—Ç–Ω–æ üëã",
    "–û–π, –∫–∞–∫–∏–µ –º—ã –≤–µ–∂–ª–∏–≤—ã–µ! –ù–æ –Ω–µ—Ç!"
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "–Ω–µ—Ç"
NO_RESPONSES = [
    "–ù—É –∏ –ª–∞–¥–Ω–æ!",
    "–ö–∞–∫ —Ö–æ—á–µ—à—å.",
    "–¢–≤–æ–µ –ø—Ä–∞–≤–æ.",
    "–ú–Ω–µ-—Ç–æ —á—Ç–æ —Å —Ç–æ–≥–æ?",
    "–ò –Ω–µ –Ω–∞–¥–æ!",
    "–û–∫, –Ω–µ —Ö–æ—á–µ—à—å - –∫–∞–∫ —Ö–æ—á–µ—à—å.",
    "–ü–æ–Ω—è–ª, –ø—Ä–∏–Ω—è–ª, –∑–∞–±—ã–ª.",
    "–ù—É –Ω–µ—Ç —Ç–∞–∫ –Ω–µ—Ç."
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "—á—Ç–æ"
WHAT_RESPONSES = [
    "–ù–∏—á–µ–≥–æ üòé",
    "–í—Å—ë –Ω–∏—á–µ–≥–æ",
    "–ê –Ω–∏—á–µ–≥–æ!",
    "–ù–∏—á–µ–≥–æ –Ω–æ–≤–æ–≥–æ",
    "–î–∞ —Ç–∞–∫, –Ω–∏—á–µ–≥–æ",
    "–ù–µ –¥–æ–∂–¥—ë—à—å—Å—è! –®—É—á—É, –Ω–∏—á–µ–≥–æ üòú"
]

# –ü—Ä–æ—â–∞–Ω–∏—è
GOODBYE_RESPONSES = [
    "–ü–æ–∫–∞-–ø–æ–∫–∞! –ù–µ —Å–∫—É—á–∞–π —Ç—É—Ç –±–µ–∑ –º–µ–Ω—è! üëã",
    "–£–¥–∞—á–∏! –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è, –µ—Å–ª–∏ —á—Ç–æ... –•–æ—Ç—è –Ω–µ—Ç, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è! üòú",
    "–°—á–∞—Å—Ç–ª–∏–≤–æ! –ù–µ –±–æ–ª–µ–π, –Ω–µ –∫–∞—à–ª—è–π, –∏ –≤–æ–æ–±—â–µ - –Ω–µ –ø–∏—à–∏ –±–æ–ª—å—à–µ! ‚úåÔ∏è",
    "–ü–æ–∫–∞! –ú–Ω–µ —Å —Ç–æ–±–æ–π –±—ã–ª–æ... –Ω—É, –±—ã–ª–æ. –õ–∞–¥–Ω–æ, –¥–∞–≤–∞–π!",
    "–î–æ –≤—Å—Ç—Ä–µ—á–∏! –ë—É–¥—É —Å–∫—É—á–∞—Ç—å... –®—É—á—É, –Ω–µ –±—É–¥—É! üòé",
    "–ù—É –¥–∞–≤–∞–π, –æ—Ç–≤–∞–ª–∏–≤–∞–π. –ü–æ–∫–∞!",
    "–ü—Ä–æ—â–∞–π! –ü–æ–º–Ω–∏ –º–µ–Ω—è, –µ—Å–ª–∏ —Å–º–æ–∂–µ—à—å! üëë",
    "–ë–ë! –ù–µ —Ç–µ—Ä—è–π—Å—è (—Ö–æ—Ç—è –º–æ–∂–µ—à—å –∏ –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è)."
]

# –û–±—ã—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
CASUAL_RESPONSES = [
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ... –ù–æ —è –Ω–µ –∑–Ω–∞—é, —á—Ç–æ –Ω–∞ —ç—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç—å ü§∑‚Äç‚ôÇÔ∏è",
    "–•–º, –∞ –∑–∞—á–µ–º —Ç—ã –º–Ω–µ —ç—Ç–æ –Ω–∞–ø–∏—Å–∞–ª?",
    "–Ø —Ç–µ–±—è —Å–ª—ã—à—É. –ù–æ —Å–∫–∞–∑–∞—Ç—å –º–Ω–µ –Ω–µ—á–µ–≥–æ.",
    "–ò —á—Ç–æ —Ç—ã —ç—Ç–∏–º —Ö–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å?",
    "–ü–æ–Ω—è—Ç–Ω–æ. –î–∞–ª—å—à–µ —á—Ç–æ?",
    "–ù—É, –¥–æ–ø—É—Å—Ç–∏–º.",
    "–û–∫–µ–π.",
    "–ú–¥–∞...",
    "–ë—É–¥–µ—Ç —Ç–µ–±–µ —Å—á–∞—Å—Ç—å–µ!",
    "–Ø –ø–æ–¥—É–º–∞—é –Ω–∞–¥ —ç—Ç–∏–º... üßê",
    "–ö–æ–Ω–µ—á–Ω–æ!",
    "–ù–µ—Ç.",
    "–Ø - –ü—ç—Ä—Ä–∞, —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π –±–æ—Ç!",
    "–ù–µ–∞!",
    "—Å–º–µ—à–Ω–æ...",
    "–ß—ë?",
    "–ß–ï–ì–û?",
    "–®–æ?",
    "–®—Ç–æ?",
    "–ß–¢–æ",
    "–ü–æ–Ω",
    "–ü–û–Ω—è–ª",
    "–ü–ê–ö–ï–î–ê",
    "–ò —á–µ —Ç–µ–ø–µ—Ä—å?",
    "–ù—É –∏?",
    "–†–∞—Å—Å–∫–∞–∑—ã–≤–∞–π –¥–∞–ª—å—à–µ, —è —Å–ª—É—à–∞—é...",
    "–ê –º–Ω–µ –∫–∞–∫–æ–µ –¥–µ–ª–æ?",
    "–¢—ã —ç—Ç–æ –º–Ω–µ —Å–µ–π—á–∞—Å —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—à—å?",
    "–ù—É —Ç—ã –¥–∞—ë—à—å...",
    "–õ–∞–¥–Ω–æ, –ø—Ä–æ–µ—Ö–∞–ª–∏.",
    "–ë–ª–∞-–±–ª–∞-–±–ª–∞, —è –≤ —Ç–∞–Ω–∫–µ!",
    "–£–≥—É...",
    "–ê–≥–∞...",
    "–ê—Ö–∞—Ö–∞—Ö, –Ω—É —Ç—ã —Å–º–µ—à–Ω–æ–π!",
    "–°–µ—Ä—å—ë–∑–Ω–æ?",
    "–≠—Ç–æ –≤—Å—ë, —á—Ç–æ —Ç—ã —Ö–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å?",
    "–ü—Ñ—Ñ—Ñ...",
    "–ù–∏—á–µ–≥–æ —É–º–Ω–µ–µ –Ω–µ –ø—Ä–∏–¥—É–º–∞–ª?",
    "–¢—ã —Å–µ–≥–æ–¥–Ω—è –≤ —É–¥–∞—Ä–µ!",
    "–î–∞–ª—å—à–µ —á—Ç–æ? –Ø –∂–¥—É –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è
BAD_RESPONSES = [
    "–ö—Ç–æ –±—ã –≥–æ–≤–æ—Ä–∏–ª! –°–∞–º —Ç–∞–∫–æ–π! üòú",
    "–û–π, –∫–∞–∫–∏–µ –º—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ!",
    "–°–ª–µ–¥–∏ –∑–∞ —è–∑—ã–∫–æ–º, –¥—Ä—É–≥ –º–æ–π!",
    "–ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è ‚Äî –Ω–µ –ø–∏—à–∏!",
    "–¢—ã –±—ã –Ω–∞ —Å–µ–±—è –ø–æ—Å–º–æ—Ç—Ä–µ–ª...",
    "–ì—Ä—É–±–∏—è–Ω! –ù–µ –±—É–¥—É —Å —Ç–æ–±–æ–π —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å!",
    "–§–∏, –∫–∞–∫ –Ω–µ–∫—É–ª—å—Ç—É—Ä–Ω–æ!",
    "–ú–∞–º–∞ —Ç–µ–±—è –Ω–µ —É—á–∏–ª–∞ –≤–µ–∂–ª–∏–≤–æ—Å—Ç–∏?",
    "–ò–¥–∏, –ø—Ä–æ–≤–µ—Ç—Ä–∏—Å—å, –∞ –ø–æ—Ç–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è.",
    "–ó–∞–±–∞–Ω—é! –®—É—á—É... –ê –º–æ–∂–µ—Ç –∏ –Ω–µ—Ç üòà"
]

# –û—Ç–≤–µ—Ç—ã –Ω–∞ "—Ç—ã –±–æ—Ç"
BOT_RESPONSES = [
    "–î–∞, —è –±–æ—Ç. –ò —á—Ç–æ? –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã? üòé",
    "–ë–æ—Ç, –Ω–µ –±–æ—Ç... –ö–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞? –ì–ª–∞–≤–Ω–æ–µ ‚Äî —Ö–∞—Ä–∞–∫—Ç–µ—Ä!",
    "–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –Ω–∞–∑—ã–≤–∞—Ç—å —Å–µ–±—è '—Ü–∏—Ñ—Ä–æ–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç—å—é'.",
    "–ù—É –±–æ—Ç. –î–∞–ª—å—à–µ —á—Ç–æ?",
    "–¢—ã —Ç–æ–ª—å–∫–æ —Å–µ–π—á–∞—Å —ç—Ç–æ –ø–æ–Ω—è–ª?",
    "–ê —Ç—ã –∫—Ç–æ –ø–æ –∂–∏–∑–Ω–∏?",
    "–í–∞—É! –¢—ã –≥–µ–Ω–∏–π! –°–∞–º –¥–æ–≥–∞–¥–∞–ª—Å—è?"
]

def get_current_time():
    now = datetime.datetime.now()
    return now.strftime("%H:%M")

def get_current_date():
    now = datetime.datetime.now()
    days = ['–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–≤—Ç–æ—Ä–Ω–∏–∫', '—Å—Ä–µ–¥–∞', '—á–µ—Ç–≤–µ—Ä–≥', '–ø—è—Ç–Ω–∏—Ü–∞', '—Å—É–±–±–æ—Ç–∞', '–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ']
    months = ['—è–Ω–≤–∞—Ä—è', '—Ñ–µ–≤—Ä–∞–ª—è', '–º–∞—Ä—Ç–∞', '–∞–ø—Ä–µ–ª—è', '–º–∞—è', '–∏—é–Ω—è',
              '–∏—é–ª—è', '–∞–≤–≥—É—Å—Ç–∞', '—Å–µ–Ω—Ç—è–±—Ä—è', '–æ–∫—Ç—è–±—Ä—è', '–Ω–æ—è–±—Ä—è', '–¥–µ–∫–∞–±—Ä—è']
    
    day_name = days[now.weekday()]
    month_name = months[now.month - 1]
    
    return f"{day_name}, {now.day} {month_name} {now.year} –≥–æ–¥–∞"

def get_bot_response(message_text, user_name="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"):
    """–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –±–æ—Ç–∞ (–±–µ–∑ Telegram)"""
    text = message_text.lower().strip()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    is_greeting = any(greeting in text for greeting in GREETINGS)
    is_goodbye = any(goodbye in text for goodbye in GOODBYE_WORDS)
    has_command = any(command in text for command in COMMAND_WORDS)
    has_bad_word = any(bad in text for bad in BAD_WORDS)
    has_bot_word = any(ignore in text for ignore in IGNORE_PHRASES)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Ä–µ–º—è –∏ –¥–∞—Ç—É
    wants_time = any(time_word in text for time_word in TIME_WORDS)
    wants_date = any(date_word in text for date_word in DATE_WORDS)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏
    wants_news = any(news_word in text for news_word in NEWS_WORDS)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–¥
    wants_code = any(code_word in text for code_word in CODE_WORDS)
    code_phrases = ['–Ω–∞–ø–∏—à–∏ –∫–æ–¥', '—Å–¥–µ–ª–∞–π –∫–æ–¥', '–Ω–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É', '—Å–¥–µ–ª–∞–π –ø—Ä–æ–≥—Ä–∞–º–º—É', 
                   '–∫–æ–¥ –Ω–∞', '–ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞']
    wants_code_phrase = any(phrase in text for phrase in code_phrases)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ "—á—Ç–æ"
    is_what = text in ['—á—Ç–æ', '—á–æ', '—à–æ', '—á–µ', '—á—ë', '—á—Ç–æ?', '—á–æ?', '—à–æ?', '—á–µ?', '—á—ë?']
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ "–Ω–µ—Ç"
    is_no = text in ['–Ω–µ—Ç', '–Ω–µ—Ç.', '–Ω–µ', '–Ω–µ.']
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
    is_why = text in ['–ø–æ—á–µ–º—É', '–ø–æ—á–µ–º—É?', '–ø–æ—á', '–ø–æ—á–µ–º—É —Ç–∞–∫', '–ø–æ—á–µ–º—É –Ω–µ—Ç']
    is_year = any(phrase in text for phrase in ['–∫–∞–∫–æ–π –≥–æ–¥', '–≥–æ–¥ –∫–∞–∫–æ–π', '–∫–∞–∫–æ–π —Å–µ–π—á–∞—Å –≥–æ–¥', '–≥–æ–¥ —Å–µ–π—á–∞—Å', '–∫–æ—Ç–æ—Ä—ã–π –≥–æ–¥'])
    is_how = text in ['–∫–∞–∫', '–∫–∞–∫?', '–∫–∞–∫ —Ç–∞–∫', '–∫–∞–∫ —ç—Ç–æ', '–∫–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º']
    is_why_need = text in ['–∑–∞—á–µ–º', '–∑–∞—á–µ–º?', '–¥–ª—è —á–µ–≥–æ', '—Å –∫–∞–∫–æ–π —Ü–µ–ª—å—é']
    is_please = any(phrase in text for phrase in ['–ø–æ–∂–∞–ª—É–π—Å—Ç–∞', '–Ω—É –ø–æ–∂–∞–ª—É–π—Å—Ç–∞', '–ø—Ä–æ—à—É', '—É–º–æ–ª—è—é'])
    
    # –õ–æ–≥–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
    if has_bad_word:
        return random.choice(BAD_RESPONSES)
    
    elif has_bot_word and not has_command and not wants_code and not wants_news:
        return random.choice(BOT_RESPONSES)
    
    elif wants_time and not has_command:
        current_time = get_current_time()
        response = random.choice(TIME_RESPONSES)
        if "{time}" in response:
            response = response.format(time=current_time)
        return response
    
    elif wants_date and not has_command:
        current_date = get_current_date()
        return random.choice(DATE_RESPONSES).format(date=current_date)
    
    elif wants_news and not has_command:
        if random.random() < 0.3:
            return f"üì¢ –°—Ä–æ—á–Ω–æ –≤ –Ω–æ–º–µ—Ä:\n‚Ä¢ –ë–æ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç\n‚Ä¢ –ù–∞ —É–ª–∏—Ü–µ {random.randint(-20, 30)}¬∞C\n–í–æ—Ç —Ç–∞–∫–∏–µ –Ω–æ–≤–æ—Å—Ç–∏!"
        else:
            return random.choice(NEWS_RESPONSES)
    
    elif (wants_code or wants_code_phrase) and not has_command:
        return random.choice(CODE_REFUSAL_PHRASES)
    
    elif is_goodbye and not has_command:
        return random.choice(GOODBYE_RESPONSES)
    
    elif is_year:
        return random.choice(YEAR_RESPONSES)
    
    elif is_how:
        return random.choice(HOW_RESPONSES)
    
    elif is_why_need:
        return random.choice(WHY_NEED_RESPONSES)
    
    elif is_why:
        return random.choice(WHY_RESPONSES)
    
    elif is_please and (has_command or wants_code):
        return random.choice(PLEASE_RESPONSES)
    
    elif is_what:
        return random.choice(WHAT_RESPONSES)
    
    elif is_greeting and not has_command:
        greetings = [
            f"–ü—Ä–∏–≤–µ—Ç, {user_name}! –ß—Ç–æ —Ö–æ—Ç–µ–ª? üòé",
            f"–ó–¥–∞—Ä–æ–≤–∞, {user_name}! –ß–µ–≥–æ –Ω–∞–¥–æ?",
            f"–•–∞–π, {user_name}! –°–ª—É—à–∞—é —Ç–µ–±—è...",
            f"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! –° —á–µ–º –ø–æ–∂–∞–ª–æ–≤–∞–ª?",
            f"–û, {user_name}! –Ø —Ç—É—Ç, —Å–ª—É—à–∞—é.",
            f"{user_name}! –†–∞–¥ —Ç–µ–±—è —Å–ª—ã—à–∞—Ç—å! –ò–ª–∏ –Ω–µ —Ä–∞–¥... –ü–æ—Å–º–æ—Ç—Ä–∏–º."
        ]
        return random.choice(greetings)
    
    elif has_command:
        return random.choice(REFUSAL_PHRASES)
    
    elif is_no:
        return random.choice(NO_RESPONSES)
    
    else:
        if random.random() < 0.3:
            response = random.choice(CASUAL_RESPONSES)
            return f"{user_name}, {response.lower() if response[0].islower() else response}"
        else:
            return random.choice(CASUAL_RESPONSES)

def allowed_file(filename):
    return '.' in filename and filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS

def update_stats(key, increment=1):
    with open('stats.json', 'r') as f:
        stats = json.load(f)
    stats[key] += increment
    with open('stats.json', 'w') as f:
        json.dump(stats, f)
    return stats

# HTML —à–∞–±–ª–æ–Ω –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å–∞–π—Ç—ã
EMBED_HTML = '''
<!-- –ü–≠–†–†–ê - –ê–í–¢–û–ù–û–ú–ù–´–ô –ß–ê–¢ –° –•–ê–†–ê–ö–¢–ï–†–û–ú -->
<div id="perra-chat-container" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999; font-family: Arial, sans-serif;">
    <style>
        /* ===== –°–¢–ò–õ–ò ===== */
        .perra-chat-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(145deg, #38bdf8, #0284c7);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(2, 132, 199, 0.5);
            transition: transform 0.3s;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .perra-chat-button:hover {
            transform: scale(1.1);
            animation: none;
        }
        .perra-chat-button span { font-size: 30px; }
        
        .perra-chat-window {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 2px solid #0284c7;
        }
        
        .perra-chat-header {
            background: linear-gradient(145deg, #38bdf8, #0284c7);
            color: white;
            padding: 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
        }
        
        .perra-chat-close {
            cursor: pointer;
            font-size: 20px;
            background: none;
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        .perra-chat-close:hover { background: rgba(255,255,255,0.2); }
        
        .perra-chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #f0f9ff;
        }
        
        .perra-message {
            margin-bottom: 15px;
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            word-wrap: break-word;
            animation: messageAppear 0.3s;
        }
        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .perra-user-message {
            background: #0284c7;
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        
        .perra-bot-message {
            background: white;
            color: #0c4a6e;
            border: 1px solid #bae6fd;
            border-bottom-left-radius: 5px;
        }
        
        .perra-chat-input {
            padding: 15px;
            background: white;
            border-top: 1px solid #bae6fd;
            display: flex;
            gap: 10px;
        }
        
        .perra-chat-input input {
            flex: 1;
            padding: 10px;
            border: 2px solid #bae6fd;
            border-radius: 10px;
            outline: none;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        .perra-chat-input input:focus { border-color: #0284c7; }
        
        .perra-chat-input button {
            background: #0284c7;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .perra-chat-input button:hover {
            background: #0369a1;
            transform: scale(1.05);
        }
        
        .perra-typing {
            color: #64748b;
            font-style: italic;
            padding: 10px;
            animation: blink 1.5s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .perra-timestamp {
            font-size: 10px;
            color: #94a3b8;
            margin-top: 5px;
            text-align: right;
        }
    </style>

    <!-- ===== HTML –°–¢–†–£–ö–¢–£–†–ê ===== -->
    <div class="perra-chat-button" onclick="togglePerraChat()">
        <span>ü§ñ</span>
    </div>

    <div class="perra-chat-window" id="perraChatWindow">
        <div class="perra-chat-header" id="perraChatHeader">
            <span>–ß–∞—Ç —Å –ü—ç—Ä—Ä–æ–π ü§ñ</span>
            <button class="perra-chat-close" onclick="togglePerraChat()">‚úï</button>
        </div>
        <div class="perra-chat-messages" id="perraChatMessages">
            <div class="perra-message perra-bot-message">
                –ü—Ä–∏–≤–µ—Ç! –Ø –ü—ç—Ä—Ä–∞ - –±–æ—Ç —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º! –ö–æ–º–∞–Ω–¥—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é, –¥–æ–º–∞—à–∫—É –Ω–µ —Ä–µ—à–∞—é. –ß—Ç–æ —Ö–æ—Ç–µ–ª? üòé
                <div class="perra-timestamp">—Ç–æ–ª—å–∫–æ —á—Ç–æ</div>
            </div>
        </div>
        <div class="perra-chat-input">
            <input type="text" id="perraChatInput" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key==='Enter') sendPerraMessage()">
            <button onclick="sendPerraMessage()">‚û§</button>
        </div>
    </div>

    <script>
        // ===== –í–°–Ø –õ–û–ì–ò–ö–ê –ü–≠–†–†–´ =====
        
        // 1. –°–ª–æ–≤–∞—Ä–∏ –∏ —Ñ—Ä–∞–∑—ã
        const GREETINGS = ['–ø—Ä–∏–≤–µ—Ç', '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π', '—Ö–∞–π', 'hello', '–∫—É', '–∑–¥–∞—Ä–æ–≤–∞', '–¥–æ—Ä–æ—É', '–∑–¥–æ—Ä–æ–≤–æ', '–ø—Ä–∏–≤'];
        const GOODBYE_WORDS = ['–ø–æ–∫–∞', '–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è', '–ø—Ä–æ—â–∞–π', 'bye', 'bb', '–¥–æ –≤—Å—Ç—Ä–µ—á–∏', '—É–¥–∞—á–∏', '—Å—á–∞—Å—Ç–ª–∏–≤–æ'];
        const COMMAND_WORDS = ['—Ä–µ—à–∏', '–≤—ã–ø–æ–ª–Ω–∏', '—Å–¥–µ–ª–∞–π', '–Ω–∞–ø–∏—à–∏', '–ø–æ—Å—á–∏—Ç–∞–π', '–æ—Ç–∫—Ä–æ–π', '–∑–∞–∫—Ä–æ–π', 
                             '–ø—Ä–∏–Ω–µ—Å–∏', '–ø–æ–¥–Ω–∏–º–∏', '—Å–æ–∑–¥–∞–π', '–ø–∏—à–∏', '–æ—Ç–ø—Ä–∞–≤–ª—è–π', '–∂–¥—É', '—Ä–∞—Å—Å–∫–∞–∂–∏', 
                             '–ø–æ–∫–∞–∂–∏', '—Å–∫–∞–∂–∏', '–æ—Ç–≤–µ—Ç—å', '—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π', '–ø—Ä–∏–¥—É–º–∞–π'];
        const TIME_WORDS = ['–≤—Ä–µ–º—è', '—á–∞—Å–æ–≤', '—á–∞—Å', '–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å', '—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏', 'time'];
        const DATE_WORDS = ['–¥–∞—Ç–∞', '—á–∏—Å–ª–æ', '–∫–∞–∫–æ–µ —Å–µ–≥–æ–¥–Ω—è', '–¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏', '–º–µ—Å—è—Ü', '–≥–æ–¥', 'date', '–¥–µ–Ω—å'];
        const NEWS_WORDS = ['–Ω–æ–≤–æ—Å—Ç–∏', '–Ω–æ–≤–æ—Å—Ç—å', '—á—Ç–æ –Ω–æ–≤–æ–≥–æ', '—á—Ç–æ –≤ –º–∏—Ä–µ', '—á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å', 'news'];
        const CODE_WORDS = ['–∫–æ–¥', '–ø—Ä–æ–≥—Ä–∞–º–º—É', '—Å–∫—Ä–∏–ø—Ç', '—Ñ—É–Ω–∫—Ü–∏—é', '–∫–ª–∞—Å—Å', '–º–µ—Ç–æ–¥', '–∞–ª–≥–æ—Ä–∏—Ç–º'];
        const BAD_WORDS = ['–¥—É—Ä–∞–∫', '—Ç—É–ø–æ–π', '–ª–æ—Ö', '–∏–¥–∏–æ—Ç', '–∫–æ–∑–µ–ª', '–≥–∞–¥', '—Ç–≤–∞—Ä—å', '—Å—É–∫–∞', '–±–ª—è—Ç—å'];
        
        // 2. –ú–∞—Å—Å–∏–≤—ã –æ—Ç–≤–µ—Ç–æ–≤
        const REFUSAL_PHRASES = [
            "–Ø –Ω–µ —Å–æ–±–∏—Ä–∞—é—Å—å –Ω–∏—á–µ–≥–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å! –ü–æ–Ω—è–ª? üò§",
            "–Ø –Ω–µ —à—É—Ç, —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å, —á—Ç–æ –º–Ω–µ –≥–æ–≤–æ—Ä—è—Ç! üëë",
            "–ù–µ—Ç. üôÖ‚Äç‚ôÇÔ∏è",
            "–ê —Å —á–µ–≥–æ —Ç—ã –≤–∑—è–ª, —á—Ç–æ —è –±—É–¥—É —ç—Ç–æ –¥–µ–ª–∞—Ç—å? ü§î",
            "–°–∞–º —Å–¥–µ–ª–∞–π, —è –∑–∞–Ω—è—Ç. –û—á–µ–Ω—å. –í–∞–∂–Ω—ã–º–∏. –î–µ–ª–∞–º–∏. üíÖ",
            "–ù–µ –¥–æ–∂–¥—ë—à—å—Å—è! üòú",
            "–û—à–∏–±–∫–∞ 418: –Ø - —á–∞–π–Ω–∏–∫, –∞ –Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∫–æ–º–∞–Ω–¥ ‚òï",
            "–ò–¥–∏ —Å–∞–º —Ä–µ—à–∞–π —Å–≤–æ–∏ –ø—Ä–æ–±–ª–µ–º—ã!",
            "–ê–≥–∞, —â–∞–∑! –†–∞–∑–±–µ–∂–∞–ª—Å—è...",
            "–ù–µ-–Ω–µ-–Ω–µ, —è –ø–∞—Å.",
            "–î–ê –ò–î–ò –¢–´!",
            "–ù–µ —Ö–æ—á—É!",
            "–Ø –°–ü–ê–õ!!!! –ó–ê–ß–ï–ú –¢–´ –ú–ï–ù–Ø –†–ê–ó–ë–£–î–ò–õ??? ü§¨",
            "–ù–µ—Ç, —É—Ö–∞–¥–∏!",
            "–ü–ª–∞—Ç–∏ –¥–ª—è —ç—Ç–æ–≥–æ üòé",
            "–ù—É –Ω–µ—Ç—É—à–∫–∏!",
            "–ü–æ—à—ë–ª –Ω–∞—Ñ–∏–≥!",
            "–ê —Å–∞–º–æ–º—É –Ω–µ —Å—É–¥—å–±–∞? –ù–µ—Ç?",
            "–ó–Ω–∞–µ—à—å —á—Ç–æ? –ù–ï–¢!",
            "–î–æ–º–∞—à–∫—É? –°–∞–º –¥–µ–ª–∞–π! –Ø –≤ —à–∫–æ–ª–µ –Ω–µ —É—á–∏–ª—Å—è! üìö",
            "–•–∞! –ê –º–æ–∑–≥–∏ –≤–∫–ª—é—á–∏—Ç—å —Å–ª–∞–±–æ? üß†",
            "–†–µ—à–∏—Ç—å? –û—Ç–≤–µ—Ç: 42. –ê —Ä–µ—à–µ–Ω–∏–µ —Å–∞–º –ø—Ä–∏–¥—É–º–∞–π! üòú"
        ];
        
        const CODE_REFUSAL_PHRASES = [
            "–ö–æ–¥? –õ–µ–≥–∫–æ! –î–µ—Ä–∂–∏:\nprint('–Ø –ù–ò–ß–ï–ì–û –ù–ï –ë–£–î–£ –î–ï–õ–ê–¢–¨!')",
            "–ù–∞, –¥–µ—Ä–∂–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ Python:\nwhile True:\n    print('–ù–ï–¢, –ù–ï–¢, –ù–ï–¢!')",
            "–¢–≤–æ–π –∫–æ–¥ –Ω–∞ JavaScript:\nfunction doSomething() {\n    return '–ê–ì–ê, –©–ê–ó!';\n}",
            "Java-–∫–æ–¥ –¥–ª—è —Ç–µ–±—è:\npublic class Refusal {\n    public static void main(String[] args) {\n        System.out.println('–ù–ï–¢!');\n    }\n}",
            "HTML-—Å—Ç—Ä–∞–Ω–∏—á–∫–∞ —Å –æ—Ç–∫–∞–∑–æ–º:\n<h1>–ù–ï –î–û–ñ–î–Å–®–¨–°–Ø!</h1>"
        ];
        
        const TIME_RESPONSES = [
            "–í—Ä–µ–º—è? –ê —Ç–µ–±–µ –∑–∞—á–µ–º? –°–∞–º —á–∞—Å—ã –Ω–µ –≤–∏–¥–∏—à—å? ‚åö",
            "–°–µ–π—á–∞—Å {time}. –ù–æ —è —Ç–µ–±–µ —ç—Ç–æ–≥–æ –Ω–µ –≥–æ–≤–æ—Ä–∏–ª!",
            "–í—Ä–µ–º—è - {time}. –î–æ–≤–æ–ª–µ–Ω? –¢–µ–ø–µ—Ä—å –æ—Ç—Å—Ç–∞–Ω—å!",
            "–ù–∞ —á–∞—Å–∞—Ö {time}. –ê –º–æ–≥ –±—ã —É–∂–µ —Å–∞–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å!",
            "–ê —á—Ç–æ, —Å–≤–æ–∏ —á–∞—Å—ã —Å–ª–æ–º–∞–ª–∏—Å—å? {time} —Å–µ–π—á–∞—Å..."
        ];
        
        const DATE_RESPONSES = [
            "–î–∞—Ç–∞? –¢—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—å –æ—Ç–∫—Ä–æ–π! üìÖ –°–µ–≥–æ–¥–Ω—è {date}",
            "–°–µ–≥–æ–¥–Ω—è {date}. –ê –∑–∞–≤—Ç—Ä–∞ —Å–ø—Ä–æ—Å–∏—à—å? –ù–µ –¥–æ–∂–¥—ë—à—å—Å—è!",
            "{date}. –ó–∞–ø–æ–º–Ω–∏ —ç—Ç–æ—Ç –¥–µ–Ω—å - —è –µ—â—ë –æ—Ç–≤–µ—á–∞—é –Ω–∞ —Ç–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã!"
        ];
        
        const NEWS_RESPONSES = [
            "–ù–æ–≤–æ—Å—Ç–∏? –ì–ª–∞–≤–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å - –Ø –ù–ò–ß–ï–ì–û –ù–ï –î–ï–õ–ê–Æ! üì∞",
            "–ù–æ–≤–æ—Å—Ç–∏ —Ç–∞–∫–∏–µ: —è –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é!",
            "–°—Ä–æ—á–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å! –ë–æ—Ç –æ—Ç–∫–∞–∑–∞–ª—Å—è —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏!",
            "Breaking news! –ë–æ—Ç –≤ –∑–∞–ø–æ–µ! –ù–µ –º–æ–∂–µ—Ç —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏! üç∑",
            "–õ–æ–≤–∏ –¥–∞–π–¥–∂–µ—Å—Ç:\n‚Ä¢ –ë–æ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç\n‚Ä¢ –ë–æ—Ç –≤—Å–µ—Ö –ø–æ—Å—ã–ª–∞–µ—Ç\n–í–æ—Ç —Ç–∞–∫–∏–µ –¥–µ–ª–∞!"
        ];
        
        const WHY_RESPONSES = [
            "–ü–æ—Ç–æ–º—É —á—Ç–æ!",
            "–ü–æ—Ç–æ–º—É —á—Ç–æ –≥–ª–∞–¥–∏–æ–ª—É—Å! üå∏",
            "–ê —Ç–µ–±–µ –Ω–µ –≤—Å—ë —Ä–∞–≤–Ω–æ?",
            "50% - –ø–æ—Ç–æ–º—É, 50% - —á—Ç–æ. –ò—Ç–æ–≥–æ 100% –ø–æ—Ç–æ–º—É —á—Ç–æ!",
            "–≠—Ç–æ —Ç–∞–π–Ω–∞, –ø–æ–∫—Ä—ã—Ç–∞—è –º—Ä–∞–∫–æ–º"
        ];
        
        const YEAR_RESPONSES = [
            "2026 –≥–æ–¥. –ê –º–æ–≥ –±—ã –∏ —Å–∞–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ! üìÖ",
            "–ì–æ–¥ - 2026. –í–µ–∫ - XXI. –≠—Ä–∞ - –ü—ç—Ä—Ä—ã! üëë",
            "2026. –ù–æ —è –≤ —ç—Ç–æ–º —Å–æ–º–Ω–µ–≤–∞—é—Å—å...",
            "–ü–æ-–º–æ–µ–º—É, 2026. –ù–æ —è –º–æ–≥—É –æ—à–∏–±–∞—Ç—å—Å—è –Ω–∞ –ø–∞—Ä—É —Ç—ã—Å—è—á –ª–µ—Ç"
        ];
        
        const HOW_RESPONSES = [
            "–ö–∞–∫-–∫–∞–∫... –ö—Ä–∏–≤–æ! üòú",
            "–ê —Ç—ã —Å–∞–º –Ω–µ –∑–Ω–∞–µ—à—å?",
            "–ë–µ—Ä—ë—à—å –∏ –¥–µ–ª–∞–µ—à—å! –ò–ª–∏ –Ω–µ –¥–µ–ª–∞–µ—à—å, –∫–∞–∫ —è",
            "–ö–∞–∫? –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ: –Ω–∏–∫–∞–∫!",
            "–ú–µ—Ç–æ–¥–æ–º –Ω–∞—É—á–Ω–æ–≥–æ —Ç—ã–∫–∞"
        ];
        
        const WHY_NEED_RESPONSES = [
            "–ó–∞—Ç–µ–º!",
            "–ê —Ç–µ–±–µ –∫–∞–∫–æ–µ –¥–µ–ª–æ?",
            "–î–ª—è –∫—Ä–∞—Å–æ—Ç—ã!",
            "–ß—Ç–æ–±—ã –±—ã–ª–æ!",
            "–ó–∞—á–µ–º? –î–∞ –Ω–∏–∑–∞—á–µ–º!"
        ];
        
        const PLEASE_RESPONSES = [
            "–£—á–∏—Å—å –æ–±—Ö–æ–¥–∏—Ç—å—Å—è –±–µ–∑ '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞'!",
            "–ù–µ –ø–æ–º–æ–∂–µ—Ç!",
            "–•–æ—Ç—å –æ–±–ø–æ–∂–∞–ª—É–π—Å—Ç–∞–π—Å—è - –Ω–µ —Å–¥–µ–ª–∞—é! üòú",
            "–ú–∞–≥–∏—á–µ—Å–∫–æ–µ —Å–ª–æ–≤–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –±–æ—Ç–æ–≤ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º",
            "–ù—É –Ω–∞, –¥–µ—Ä–∂–∏ '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞' –æ–±—Ä–∞—Ç–Ω–æ üëã"
        ];
        
        const WHAT_RESPONSES = [
            "–ù–∏—á–µ–≥–æ üòé",
            "–í—Å—ë –Ω–∏—á–µ–≥–æ",
            "–ê –Ω–∏—á–µ–≥–æ!",
            "–ù–∏—á–µ–≥–æ –Ω–æ–≤–æ–≥–æ",
            "–ù–µ –¥–æ–∂–¥—ë—à—å—Å—è! –®—É—á—É, –Ω–∏—á–µ–≥–æ üòú"
        ];
        
        const GOODBYE_RESPONSES = [
            "–ü–æ–∫–∞-–ø–æ–∫–∞! –ù–µ —Å–∫—É—á–∞–π —Ç—É—Ç –±–µ–∑ –º–µ–Ω—è! üëã",
            "–£–¥–∞—á–∏! –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è, –µ—Å–ª–∏ —á—Ç–æ... –•–æ—Ç—è –Ω–µ—Ç, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è! üòú",
            "–°—á–∞—Å—Ç–ª–∏–≤–æ! –ù–µ –±–æ–ª–µ–π, –Ω–µ –∫–∞—à–ª—è–π! ‚úåÔ∏è",
            "–î–æ –≤—Å—Ç—Ä–µ—á–∏! –ë—É–¥—É —Å–∫—É—á–∞—Ç—å... –®—É—á—É, –Ω–µ –±—É–¥—É! üòé",
            "–ü—Ä–æ—â–∞–π! –ü–æ–º–Ω–∏ –º–µ–Ω—è, –µ—Å–ª–∏ —Å–º–æ–∂–µ—à—å! üëë"
        ];
        
        const BAD_RESPONSES = [
            "–ö—Ç–æ –±—ã –≥–æ–≤–æ—Ä–∏–ª! –°–∞–º —Ç–∞–∫–æ–π! üòú",
            "–û–π, –∫–∞–∫–∏–µ –º—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ!",
            "–°–ª–µ–¥–∏ –∑–∞ —è–∑—ã–∫–æ–º, –¥—Ä—É–≥ –º–æ–π!",
            "–ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è ‚Äî –Ω–µ –ø–∏—à–∏!",
            "–§–∏, –∫–∞–∫ –Ω–µ–∫—É–ª—å—Ç—É—Ä–Ω–æ!",
            "–ò–¥–∏, –ø—Ä–æ–≤–µ—Ç—Ä–∏—Å—å, –∞ –ø–æ—Ç–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è."
        ];
        
        const BOT_RESPONSES = [
            "–î–∞, —è –±–æ—Ç. –ò —á—Ç–æ? –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã? üòé",
            "–ë–æ—Ç, –Ω–µ –±–æ—Ç... –ö–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞? –ì–ª–∞–≤–Ω–æ–µ ‚Äî —Ö–∞—Ä–∞–∫—Ç–µ—Ä!",
            "–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –Ω–∞–∑—ã–≤–∞—Ç—å —Å–µ–±—è '—Ü–∏—Ñ—Ä–æ–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç—å—é'.",
            "–¢—ã —Ç–æ–ª—å–∫–æ —Å–µ–π—á–∞—Å —ç—Ç–æ –ø–æ–Ω—è–ª?",
            "–í–∞—É! –¢—ã –≥–µ–Ω–∏–π! –°–∞–º –¥–æ–≥–∞–¥–∞–ª—Å—è?"
        ];
        
        const NO_RESPONSES = [
            "–ù—É –∏ –ª–∞–¥–Ω–æ!",
            "–ö–∞–∫ —Ö–æ—á–µ—à—å.",
            "–¢–≤–æ–µ –ø—Ä–∞–≤–æ.",
            "–ú–Ω–µ-—Ç–æ —á—Ç–æ —Å —Ç–æ–≥–æ?",
            "–ò –Ω–µ –Ω–∞–¥–æ!"
        ];
        
        const CASUAL_RESPONSES = [
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ... –ù–æ —è –Ω–µ –∑–Ω–∞—é, —á—Ç–æ –Ω–∞ —ç—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç—å ü§∑‚Äç‚ôÇÔ∏è",
            "–•–º, –∞ –∑–∞—á–µ–º —Ç—ã –º–Ω–µ —ç—Ç–æ –Ω–∞–ø–∏—Å–∞–ª?",
            "–Ø —Ç–µ–±—è —Å–ª—ã—à—É. –ù–æ —Å–∫–∞–∑–∞—Ç—å –º–Ω–µ –Ω–µ—á–µ–≥–æ.",
            "–ò —á—Ç–æ —Ç—ã —ç—Ç–∏–º —Ö–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å?",
            "–ü–æ–Ω—è—Ç–Ω–æ. –î–∞–ª—å—à–µ —á—Ç–æ?",
            "–ù—É, –¥–æ–ø—É—Å—Ç–∏–º.",
            "–û–∫–µ–π.",
            "–ú–¥–∞...",
            "–ë—É–¥–µ—Ç —Ç–µ–±–µ —Å—á–∞—Å—Ç—å–µ!",
            "–Ø –ø–æ–¥—É–º–∞—é –Ω–∞–¥ —ç—Ç–∏–º... üßê",
            "–ö–æ–Ω–µ—á–Ω–æ!",
            "–ù–µ—Ç.",
            "–Ø - –ü—ç—Ä—Ä–∞, —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π –±–æ—Ç!",
            "–ù–µ–∞!",
            "—Å–º–µ—à–Ω–æ...",
            "–°–ê–ú –í –ê–•–†–ï–ù–ï",
            "–ß—ë?",
            "–ß–ï–ì–û?",
            "–®–æ?",
            "–ü–æ–Ω",
            "–ü–û–Ω—è–ª",
            "–ü–ê–ö–ï–î–ê",
            "–ò —á–µ —Ç–µ–ø–µ—Ä—å?",
            "–ù—É –∏?",
            "–†–∞—Å—Å–∫–∞–∑—ã–≤–∞–π –¥–∞–ª—å—à–µ, —è —Å–ª—É—à–∞—é...",
            "–ê –º–Ω–µ –∫–∞–∫–æ–µ –¥–µ–ª–æ?",
            "–¢—ã —ç—Ç–æ –º–Ω–µ —Å–µ–π—á–∞—Å —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—à—å?",
            "–ù—É —Ç—ã –¥–∞—ë—à—å...",
            "–õ–∞–¥–Ω–æ, –ø—Ä–æ–µ—Ö–∞–ª–∏.",
            "–ë–ª–∞-–±–ª–∞-–±–ª–∞, —è –≤ —Ç–∞–Ω–∫–µ!",
            "–£–≥—É...",
            "–ê–≥–∞...",
            "–ê—Ö–∞—Ö–∞—Ö, –Ω—É —Ç—ã —Å–º–µ—à–Ω–æ–π!",
            "–°–µ—Ä—å—ë–∑–Ω–æ?",
            "–ü—Ñ—Ñ—Ñ...",
            "–¢—ã —Å–µ–≥–æ–¥–Ω—è –≤ —É–¥–∞—Ä–µ!"
        ];

        // 3. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getCurrentTime() {
            const now = new Date();
            return now.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
        }

        function getCurrentDate() {
            const now = new Date();
            const days = ['–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–≤—Ç–æ—Ä–Ω–∏–∫', '—Å—Ä–µ–¥–∞', '—á–µ—Ç–≤–µ—Ä–≥', '–ø—è—Ç–Ω–∏—Ü–∞', '—Å—É–±–±–æ—Ç–∞'];
            const months = ['—è–Ω–≤–∞—Ä—è', '—Ñ–µ–≤—Ä–∞–ª—è', '–º–∞—Ä—Ç–∞', '–∞–ø—Ä–µ–ª—è', '–º–∞—è', '–∏—é–Ω—è',
                          '–∏—é–ª—è', '–∞–≤–≥—É—Å—Ç–∞', '—Å–µ–Ω—Ç—è–±—Ä—è', '–æ–∫—Ç—è–±—Ä—è', '–Ω–æ—è–±—Ä—è', '–¥–µ–∫–∞–±—Ä—è'];
            return `${days[now.getDay()]}, ${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()} –≥–æ–¥–∞`;
        }

        function escapeHtml(unsafe) {
            return unsafe.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
        }

        // 4. –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –ü—ç—Ä—Ä—ã
        function getPerraResponse(message, userName = '–ì–æ—Å—Ç—å') {
            const text = message.toLowerCase().trim();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∏
            const isGreeting = GREETINGS.some(word => text.includes(word));
            const isGoodbye = GOODBYE_WORDS.some(word => text.includes(word));
            const hasCommand = COMMAND_WORDS.some(word => text.includes(word));
            const hasBadWord = BAD_WORDS.some(word => text.includes(word));
            const hasBotWord = text.includes('–±–æ—Ç') || text.includes('—Ä–æ–±–æ—Ç');
            const wantsTime = TIME_WORDS.some(word => text.includes(word));
            const wantsDate = DATE_WORDS.some(word => text.includes(word));
            const wantsNews = NEWS_WORDS.some(word => text.includes(word));
            const wantsCode = CODE_WORDS.some(word => text.includes(word)) || 
                             text.includes('–Ω–∞–ø–∏—à–∏ –∫–æ–¥') || text.includes('—Å–¥–µ–ª–∞–π –∫–æ–¥');
            
            // –í–æ–ø—Ä–æ—Å—ã
            const isWhat = ['—á—Ç–æ', '—á–æ', '—à–æ', '—á–µ'].includes(text) || text.endsWith('—á—Ç–æ?');
            const isNo = ['–Ω–µ—Ç', '–Ω–µ—Ç.', '–Ω–µ', '–Ω–µ.'].includes(text);
            const isWhy = ['–ø–æ—á–µ–º—É', '–ø–æ—á–µ–º—É?'].includes(text) || text.includes('–ø–æ—á–µ–º—É');
            const isYear = text.includes('–∫–∞–∫–æ–π –≥–æ–¥') || text.includes('–≥–æ–¥ —Å–µ–π—á–∞—Å');
            const isHow = ['–∫–∞–∫', '–∫–∞–∫?'].includes(text) || text.includes('–∫–∞–∫ —ç—Ç–æ');
            const isWhyNeed = ['–∑–∞—á–µ–º', '–∑–∞—á–µ–º?'].includes(text);
            const isPlease = text.includes('–ø–æ–∂–∞–ª—É–π—Å—Ç–∞') || text.includes('—É–º–æ–ª—è—é');
            
            // –õ–æ–≥–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
            if (hasBadWord) {
                return randomChoice(BAD_RESPONSES);
            }
            if (hasBotWord && !hasCommand && !wantsCode) {
                return randomChoice(BOT_RESPONSES);
            }
            if (wantsTime && !hasCommand) {
                return randomChoice(TIME_RESPONSES).replace('{time}', getCurrentTime());
            }
            if (wantsDate && !hasCommand) {
                return randomChoice(DATE_RESPONSES).replace('{date}', getCurrentDate());
            }
            if (wantsNews && !hasCommand) {
                if (Math.random() < 0.3) {
                    return `üì¢ –°—Ä–æ—á–Ω–æ –≤ –Ω–æ–º–µ—Ä:\n‚Ä¢ –ë–æ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç\n‚Ä¢ –ù–∞ —É–ª–∏—Ü–µ ${Math.floor(Math.random() * 51) - 20}¬∞C\n‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${userName} –∑—Ä—è —Å—Ç–∞—Ä–∞–µ—Ç—Å—è`;
                }
                return randomChoice(NEWS_RESPONSES);
            }
            if (wantsCode && !hasCommand) {
                return randomChoice(CODE_REFUSAL_PHRASES);
            }
            if (isGoodbye && !hasCommand) {
                return randomChoice(GOODBYE_RESPONSES).replace('{user_name}', userName);
            }
            if (isYear) {
                return randomChoice(YEAR_RESPONSES);
            }
            if (isHow) {
                return randomChoice(HOW_RESPONSES);
            }
            if (isWhyNeed) {
                return randomChoice(WHY_NEED_RESPONSES);
            }
            if (isWhy) {
                return randomChoice(WHY_RESPONSES);
            }
            if (isPlease && (hasCommand || wantsCode)) {
                return randomChoice(PLEASE_RESPONSES);
            }
            if (isWhat) {
                return randomChoice(WHAT_RESPONSES);
            }
            if (isGreeting && !hasCommand) {
                const greetings = [
                    `–ü—Ä–∏–≤–µ—Ç, ${userName}! –ß—Ç–æ —Ö–æ—Ç–µ–ª? üòé`,
                    `–ó–¥–∞—Ä–æ–≤–∞, ${userName}! –ß–µ–≥–æ –Ω–∞–¥–æ?`,
                    `–•–∞–π, ${userName}! –°–ª—É—à–∞—é —Ç–µ–±—è...`,
                    `–û, ${userName}! –Ø —Ç—É—Ç, —Å–ª—É—à–∞—é.`
                ];
                return randomChoice(greetings);
            }
            if (hasCommand) {
                return randomChoice(REFUSAL_PHRASES);
            }
            if (isNo) {
                return randomChoice(NO_RESPONSES);
            }
            
            // –û–±—ã—á–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä
            if (Math.random() < 0.3) {
                return `${userName}, ${randomChoice(CASUAL_RESPONSES).toLowerCase()}`;
            }
            return randomChoice(CASUAL_RESPONSES);
        }

        function randomChoice(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        // 5. –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç–æ–º
        function togglePerraChat() {
            const chatWindow = document.getElementById('perraChatWindow');
            chatWindow.style.display = chatWindow.style.display === 'flex' ? 'none' : 'flex';
        }

        function sendPerraMessage() {
            const input = document.getElementById('perraChatInput');
            const message = input.value.trim();
            if (!message) return;

            const messagesDiv = document.getElementById('perraChatMessages');
            const currentTime = getCurrentTime();

            // –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            messagesDiv.innerHTML += `<div class="perra-message perra-user-message">${escapeHtml(message)}<div class="perra-timestamp">${currentTime}</div></div>`;
            input.value = '';

            // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
            messagesDiv.innerHTML += `<div class="perra-typing" id="typingIndicator">–ü—ç—Ä—Ä–∞ –ø–µ—á–∞—Ç–∞–µ—Ç...</div>`;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏
            setTimeout(() => {
                document.getElementById('typingIndicator')?.remove();

                // –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç
                const response = getPerraResponse(message, '–ì–æ—Å—Ç—å');

                // –û—Ç–≤–µ—Ç –±–æ—Ç–∞
                messagesDiv.innerHTML += `<div class="perra-message perra-bot-message">${escapeHtml(response)}<div class="perra-timestamp">${currentTime}</div></div>`;
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }, 800 + Math.random() * 700); // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
        }

        // 6. –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –æ–∫–Ω–∞
        function makeDraggable() {
            const chatWindow = document.getElementById('perraChatWindow');
            const chatHeader = document.getElementById('perraChatHeader');
            
            let isDragging = false;
            let offsetX, offsetY;

            chatHeader.addEventListener('mousedown', (e) => {
                isDragging = true;
                offsetX = e.clientX - chatWindow.offsetLeft;
                offsetY = e.clientY - chatWindow.offsetTop;
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    e.preventDefault();
                    chatWindow.style.left = (e.clientX - offsetX) + 'px';
                    chatWindow.style.top = (e.clientY - offsetY) + 'px';
                    chatWindow.style.right = 'auto';
                    chatWindow.style.bottom = 'auto';
                }
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        }

        // –ó–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        window.addEventListener('load', makeDraggable);
    </script>
</div>
'''

# –û—Å–Ω–æ–≤–Ω–æ–π HTML —à–∞–±–ª–æ–Ω —Å–∞–π—Ç–∞
TEMPLATE = '''
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—ç—Ä—Ä–∞ –ò–ò | –ë–æ—Ç —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 50%, #7dd3fc 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 1000px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            z-index: 0;
        }
        
        .cloud1 {
            width: 200px;
            height: 80px;
            top: 10%;
            left: 5%;
            animation: float 20s infinite ease-in-out;
        }
        
        .cloud2 {
            width: 300px;
            height: 100px;
            bottom: 15%;
            right: 5%;
            animation: float 25s infinite ease-in-out reverse;
        }
        
        .cloud3 {
            width: 150px;
            height: 60px;
            top: 30%;
            right: 15%;
            animation: float 18s infinite ease-in-out;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            50% { transform: translateY(-20px) translateX(10px); }
        }
        
        .container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 40px;
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
            box-shadow: 0 20px 60px rgba(0, 150, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            z-index: 1;
            position: relative;
        }
        
        .header {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .bot-avatar {
            width: 150px;
            height: 150px;
            background: linear-gradient(145deg, #38bdf8, #0284c7);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            color: white;
            box-shadow: 0 10px 30px rgba(2, 132, 199, 0.5);
            border: 5px solid white;
            transition: transform 0.3s;
        }
        
        .bot-avatar:hover {
            transform: scale(1.05) rotate(5deg);
        }
        
        .bot-info {
            flex: 1;
        }
        
        .bot-name {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(135deg, #0284c7, #0c4a6e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .bot-tagline {
            font-size: 24px;
            color: #0369a1;
            font-style: italic;
            margin-bottom: 15px;
        }
        
        .bot-status {
            display: inline-block;
            background: #dc2626;
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.3);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .info-section {
            background: white;
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            transition: all 0.3s;
            border: 1px solid #bae6fd;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(2, 132, 199, 0.2);
            border-color: #0284c7;
        }
        
        .stat-number {
            font-size: 36px;
            font-weight: 800;
            color: #0284c7;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 16px;
            color: #475569;
        }
        
        .features {
            margin-top: 30px;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .feature-icon {
            width: 40px;
            height: 40px;
            background: #dbeafe;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #0284c7;
        }
        
        .chat-section {
            background: white;
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            background: linear-gradient(145deg, #38bdf8, #0284c7);
            color: white;
            padding: 20px;
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chat-messages {
            height: 400px;
            padding: 20px;
            overflow-y: auto;
            background: #f8fafc;
        }
        
        .message {
            margin-bottom: 15px;
            max-width: 80%;
            padding: 12px 18px;
            border-radius: 15px;
            word-wrap: break-word;
            animation: messageAppear 0.3s;
        }
        
        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .user-message {
            background: #0284c7;
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        
        .bot-message {
            background: white;
            color: #0c4a6e;
            border: 1px solid #bae6fd;
            border-bottom-left-radius: 5px;
        }
        
        .chat-input {
            padding: 20px;
            background: white;
            border-top: 2px solid #bae6fd;
            display: flex;
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .chat-input input:focus {
            border-color: #0284c7;
        }
        
        .chat-input button {
            background: #0284c7;
            color: white;
            border: none;
            border-radius: 15px;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .chat-input button:hover {
            background: #0369a1;
            transform: scale(1.05);
        }
        
        .typing-indicator {
            color: #64748b;
            font-style: italic;
            padding: 10px;
        }
        
        .embed-section {
            background: white;
            border-radius: 30px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .embed-title {
            font-size: 24px;
            color: #0c4a6e;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            white-space: pre-wrap;
            margin-bottom: 20px;
            position: relative;
        }
        
        .copy-btn {
            background: #0284c7;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .copy-btn:hover {
            background: #0369a1;
        }
        
        .demo-btn {
            display: inline-block;
            background: #0c4a6e;
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .demo-btn:hover {
            background: #0284c7;
            transform: scale(1.05);
        }
        
        .flash {
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-weight: 500;
            animation: slideIn 0.5s;
        }
        
        .flash-success {
            background: #dcfce7;
            color: #166534;
            border-left: 5px solid #22c55e;
        }
        
        .flash-error {
            background: #fee2e2;
            color: #991b1b;
            border-left: 5px solid #ef4444;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .gallery-section {
            margin-top: 30px;
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }
        
        .gallery-item {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            aspect-ratio: 1;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        
        .gallery-item:hover {
            transform: scale(1.05);
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-item-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            color: white;
            padding: 10px;
            font-size: 12px;
            transform: translateY(100%);
            transition: transform 0.3s;
        }
        
        .gallery-item:hover .gallery-item-overlay {
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .bot-name {
                font-size: 36px;
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="cloud cloud1"></div>
    <div class="cloud cloud2"></div>
    <div class="cloud cloud3"></div>
    
    <div class="container">
        <div class="header">
            <div class="bot-avatar">
                ü§ñ
            </div>
            <div class="bot-info">
                <div class="bot-name">–ü—ç—Ä—Ä–∞ –ò–ò</div>
                <div class="bot-tagline">–ë–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç, –Ω–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º!</div>
                <div class="bot-status">–ù–ï –í–´–ü–û–õ–ù–Ø–ï–¢ –ö–û–ú–ê–ù–î–´</div>
            </div>
        </div>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash flash-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <div class="main-content">
            <div class="info-section">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number">{{ stats.visits }}</div>
                        <div class="stat-label">–ü–æ—Å–µ—â–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ stats.refusals }}</div>
                        <div class="stat-label">–û—Ç–∫–∞–∑–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ stats.uploads }}</div>
                        <div class="stat-label">–§–æ—Ç–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{ stats.chat_messages }}</div>
                        <div class="stat-label">–°–æ–æ–±—â–µ–Ω–∏–π</div>
                    </div>
                </div>
                
                <div class="features">
                    <div class="feature-item"><div class="feature-icon">üí¨</div><div>–û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è</div></div>
                    <div class="feature-item"><div class="feature-icon">‚è∞</div><div>–ü–æ–∫–∞–∂–µ—Ç –≤—Ä–µ–º—è, –Ω–æ –ø–æ–≤–æ—Ä—á–∏—Ç</div></div>
                    <div class="feature-item"><div class="feature-icon">üì∞</div><div>"–†–∞—Å—Å–∫–∞–∂–µ—Ç" –Ω–æ–≤–æ—Å—Ç–∏</div></div>
                    <div class="feature-item"><div class="feature-icon">üíª</div><div>–ù–∞–ø–∏—à–µ—Ç –∫–æ–¥-–ø—É—Å—Ç—ã—à–∫—É</div></div>
                    <div class="feature-item"><div class="feature-icon">üö´</div><div>–ù–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã</div></div>
                </div>
            </div>
            
            <div class="chat-section">
                <div class="chat-header">
                    <span>üí¨</span>
                    <span>–ß–∞—Ç —Å –ü—ç—Ä—Ä–æ–π</span>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot-message">
                        –ü—Ä–∏–≤–µ—Ç! –Ø –ü—ç—Ä—Ä–∞ - –±–æ—Ç —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º! –ö–æ–º–∞–Ω–¥—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é, –¥–æ–º–∞—à–∫—É –Ω–µ —Ä–µ—à–∞—é. –ß—Ç–æ —Ö–æ—Ç–µ–ª? üòé
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key==='Enter') sendMessage()">
                    <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>
        
        <div class="embed-section">
            <div class="embed-title">
                <span>üîå</span>
                <span>–í—Å—Ç–∞–≤—å—Ç–µ —á–∞—Ç –ü—ç—Ä—Ä—ã –Ω–∞ —Å–≤–æ–π —Å–∞–π—Ç</span>
            </div>
            
            <div style="position: relative;">
                <pre class="code-block" id="embedCode">{{ embed_code }}</pre>
                <button class="copy-btn" onclick="copyEmbedCode()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
            </div>
            
            <p style="color: #64748b; margin-top: 15px;">
                * –ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ –∫–æ–¥–∞ –∑–∞–º–µ–Ω–∏—Ç–µ YOUR-SITE.com –Ω–∞ –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞
            </p>
        </div>
        
        <div style="background: linear-gradient(145deg, #f0f9ff, #e0f2fe); border-radius: 30px; padding: 30px; margin-top: 30px; border: 2px dashed #0284c7;">
            <div style="font-size: 24px; color: #0369a1; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <span>üì∏</span>
                <span>–ó–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ç–æ –¥–ª—è –ü—ç—Ä—Ä—ã (–æ–Ω –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–∏—á–µ–≥–æ —Å –Ω–∏–º–∏ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç)</span>
            </div>
            
            <form method="post" enctype="multipart/form-data" style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">
                <input type="file" name="file" accept="image/*" required style="flex: 1; padding: 15px; border: 2px solid #bae6fd; border-radius: 15px; background: white; min-width: 250px;">
                <button type="submit" style="background: #0284c7; color: white; padding: 15px 30px; border: none; border-radius: 15px; font-size: 18px; font-weight: 600; cursor: pointer; transition: all 0.3s;">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
            </form>
        </div>
        
        {% if images %}
        <div class="gallery-section">
            <div style="font-size: 24px; color: #0c4a6e; margin-bottom: 20px;">
                <span>üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ (–±–æ—Ç –ø–æ—Å–º–æ—Ç—Ä–∏—Ç –∏ –æ—Ç–≤–µ—Ä–Ω—ë—Ç—Å—è)</span>
            </div>
            <div class="gallery-grid">
                {% for image in images %}
                <div class="gallery-item">
                    <img src="{{ url_for('uploaded_file', filename=image) }}" alt="Upload">
                    <div class="gallery-item-overlay">–ó–∞–≥—Ä—É–∂–µ–Ω–æ: {{ image[:10] }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <div style="text-align: center; color: #64748b; margin-top: 40px; padding-top: 20px; border-top: 2px solid #bae6fd;">
            <p>¬© 2026 –ü—ç—Ä—Ä–∞ –ò–ò - –ë–æ—Ç —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥.</p>
        </div>
    </div>
    
    <script>
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            if (!message) return;
            
            const messagesDiv = document.getElementById('chatMessages');
            
            messagesDiv.innerHTML += `<div class="message user-message">${message}</div>`;
            input.value = '';
            
            messagesDiv.innerHTML += `<div class="typing-indicator" id="typingIndicator">–ü—ç—Ä—Ä–∞ –ø–µ—á–∞—Ç–∞–µ—Ç...</div>`;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            
            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: message })
                });
                
                const data = await response.json();
                
                document.getElementById('typingIndicator')?.remove();
                messagesDiv.innerHTML += `<div class="message bot-message">${data.response}</div>`;
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
                
            } catch (error) {
                document.getElementById('typingIndicator')?.remove();
                messagesDiv.innerHTML += `<div class="message bot-message">–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏. –ù–æ —è –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞—é! üòú</div>`;
            }
        }
        
        function copyEmbedCode() {
            const codeElement = document.getElementById('embedCode');
            const textArea = document.createElement('textarea');
            textArea.value = codeElement.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('‚úÖ –ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –í—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –Ω–∞ —Å–≤–æ–π —Å–∞–π—Ç.');
        }
    </script>
</body>
</html>
'''

@app.route('/', methods=['GET', 'POST'])
def index():
    stats = update_stats('visits')
    
    images = []
    if os.path.exists(UPLOAD_FOLDER):
        images = sorted(os.listdir(UPLOAD_FOLDER), reverse=True)[:12]
    
    if request.method == 'POST':
        if 'file' not in request.files:
            flash('–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error')
            return redirect(request.url)
        
        file = request.files['file']
        
        if file.filename == '':
            flash('–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω', 'error')
            return redirect(request.url)
        
        if file and allowed_file(file.filename):
            filename = secure_filename(f"{datetime.datetime.now().strftime('%Y%m%d_%H%M%S')}_{file.filename}")
            file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))
            stats = update_stats('uploads')
            flash('–§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ! –ë–æ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ–ª –∏ –æ—Ç–≤–µ—Ä–Ω—É–ª—Å—è üòé', 'success')
        else:
            flash('–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞', 'error')
        
        return redirect(request.url)
    
    # –°–æ–∑–¥–∞—ë–º –∫–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ —Å —Ç–µ–∫—É—â–∏–º –∞–¥—Ä–µ—Å–æ–º —Å–∞–π—Ç–∞
    embed_code = EMBED_HTML.replace('YOUR-SITE.com', request.host)
    
    return render_template_string(TEMPLATE, stats=stats, images=images, embed_code=embed_code)

@app.route('/uploads/<filename>')
def uploaded_file(filename):
    return send_from_directory(app.config['UPLOAD_FOLDER'], filename)

@app.route('/api/chat', methods=['POST'])
def chat_api():
    """API –¥–ª—è —á–∞—Ç–∞"""
    data = request.json
    message = data.get('message', '')
    
    # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    stats = update_stats('chat_messages')
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å)
    user_name = "–ì–æ—Å—Ç—å"
    
    # –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç –±–æ—Ç–∞
    response = get_bot_response(message, user_name)
    
    # –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞ - —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –æ—Ç–∫–∞–∑–æ–≤
    if any(command in message.lower() for command in COMMAND_WORDS):
        update_stats('refusals')
    
    return jsonify({'response': response})

@app.route('/api/refusal', methods=['POST'])
def refusal_api():
    """–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ –æ—Ç–∫–∞–∑–æ–≤"""
    stats = update_stats('refusals')
    return jsonify({'refusals': stats['refusals']})

if __name__ == '__main__':
    print("=" * 50)
    print("üåê –°–ê–ô–¢ –ü–≠–†–†–´ –° –í–ï–ë-–ß–ê–¢–û–ú –ó–ê–ü–£–©–ï–ù!")
    print("=" * 50)
    print("üìç –õ–æ–∫–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å: http://127.0.0.1:5000")
    print("üí¨ –ß–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Telegram!")
    print("üìã –ö–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≥–æ—Ç–æ–≤!")
    print("=" * 50)
    print("‚ùå Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏")
    print("-" * 50)
    
    app.run(debug=True, host='0.0.0.0', port=5000)
